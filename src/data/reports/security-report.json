{
  "generatedAt": "2026-02-18T02:17:25.700Z",
  "agent": "security",
  "grade": "D",
  "counts": {
    "critical": 0,
    "high": 4,
    "medium": 0,
    "low": 0
  },
  "authEnforcement": [
    {
      "endpoint": "/api/admin/pricing",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/compliance",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/approval",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/pricing-report",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/conversions",
      "status": 403,
      "protected": true,
      "severity": "ok"
    }
  ],
  "securityHeaders": [
    {
      "page": "/",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/services/send-transport",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/admin",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": "SAMEORIGIN",
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": "same-origin",
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/quote",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    }
  ],
  "infoLeakage": [
    {
      "endpoint": "/api/quote/estimate",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/contact/submit",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/ai/draft",
      "status": 401,
      "leaks": [],
      "severity": "ok"
    }
  ],
  "ssl": {
    "url": "https://afj-staging.ascendtechgroup.co.uk",
    "isHttps": true,
    "status": 200,
    "severity": "ok"
  },
  "aiAnalysis": {
    "summary": "AFJ Limited's staging environment demonstrates good API endpoint protection with proper 403 authentication enforcement on all admin endpoints. However, the application has a critical security gap: missing essential HTTP security headers across all scanned pages. The absence of X-Content-Type-Options and X-Frame-Options on public-facing pages (/, /services/send-transport, /quote) exposes the application to MIME-sniffing and clickjacking attacks. SSL/TLS is properly configured. The four high-severity findings all relate to missing security headers that are fundamental to modern web security best practices.",
    "recommendations": [
      "Immediately implement X-Content-Type-Options: nosniff header on all pages to prevent MIME-sniffing attacks",
      "Add X-Frame-Options: SAMEORIGIN header on all pages (currently only present on /admin) to prevent clickjacking",
      "Implement Strict-Transport-Security header with appropriate max-age (minimum 31536000) to enforce HTTPS across the entire domain",
      "Deploy Content-Security-Policy header with a restrictive policy tailored to your application's needs to mitigate XSS and injection attacks",
      "Add Referrer-Policy header (recommend 'strict-origin-when-cross-origin') to control sensitive information leakage in referer headers",
      "Include Permissions-Policy header to restrict access to sensitive browser APIs",
      "Configure these headers globally at the web server level (nginx/Apache) or application middleware to ensure consistency across all endpoints"
    ],
    "riskLevel": "high"
  }
}
