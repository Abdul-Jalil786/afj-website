{
  "generatedAt": "2026-02-18T11:33:25.788Z",
  "agent": "security",
  "grade": "D",
  "counts": {
    "critical": 0,
    "high": 4,
    "medium": 0,
    "low": 0
  },
  "authEnforcement": [
    {
      "endpoint": "/api/admin/pricing",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/compliance",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/approval",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/pricing-report",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/conversions",
      "status": 403,
      "protected": true,
      "severity": "ok"
    }
  ],
  "securityHeaders": [
    {
      "page": "/",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/services/send-transport",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/admin",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": "SAMEORIGIN",
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": "same-origin",
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/quote",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    }
  ],
  "infoLeakage": [
    {
      "endpoint": "/api/quote/estimate",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/contact/submit",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/ai/draft",
      "status": 401,
      "leaks": [],
      "severity": "ok"
    }
  ],
  "ssl": {
    "url": "https://afj-staging.ascendtechgroup.co.uk",
    "isHttps": true,
    "status": 200,
    "severity": "ok"
  },
  "aiAnalysis": {
    "summary": "AFJ Limited's staging environment demonstrates solid authentication controls with all admin endpoints properly protected via 403 responses. However, critical security gaps exist in HTTP security headers across multiple pages. Four pages are missing essential security headers (X-Content-Type-Options and X-Frame-Options), with additional recommended headers absent site-wide. These omissions expose the application to clickjacking, MIME-type sniffing, and cross-site scripting attacks. SSL/TLS implementation is properly configured, and API endpoints show no data leakage.",
    "recommendations": [
      "Immediately implement X-Content-Type-Options: nosniff on all pages to prevent MIME-type sniffing attacks",
      "Add X-Frame-Options: SAMEORIGIN (or DENY if embedding isn't required) to all pages to prevent clickjacking; note /admin already has SAMEORIGIN",
      "Deploy Strict-Transport-Security header with appropriate max-age (minimum 31536000) to enforce HTTPS across all pages",
      "Implement Content-Security-Policy header with restrictive default-src and script-src values to mitigate XSS risks",
      "Add Referrer-Policy: strict-origin-when-cross-origin to limit referrer exposure, noting /admin has same-origin",
      "Configure Permissions-Policy to explicitly disable unused browser features (camera, microphone, geolocation, etc.)",
      "Apply all security headers consistently across all application pages using middleware (recommended approach)"
    ],
    "riskLevel": "high"
  }
}
