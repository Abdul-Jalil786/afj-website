{
  "generatedAt": "2026-02-17T14:37:39.942Z",
  "agent": "security",
  "grade": "D",
  "counts": {
    "critical": 0,
    "high": 4,
    "medium": 0,
    "low": 0
  },
  "authEnforcement": [
    {
      "endpoint": "/api/admin/pricing",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/compliance",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/approval",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/pricing-report",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/conversions",
      "status": 403,
      "protected": true,
      "severity": "ok"
    }
  ],
  "securityHeaders": [
    {
      "page": "/",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/services/send-transport",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/admin",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": "SAMEORIGIN",
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": "same-origin",
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/quote",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    }
  ],
  "infoLeakage": [
    {
      "endpoint": "/api/quote/estimate",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/contact/submit",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/ai/draft",
      "status": 401,
      "leaks": [],
      "severity": "ok"
    }
  ],
  "ssl": {
    "url": "https://afj-staging.ascendtechgroup.co.uk",
    "isHttps": true,
    "status": 200,
    "severity": "ok"
  },
  "aiAnalysis": {
    "summary": "AFJ Limited's staging environment demonstrates strong authentication controls with all admin endpoints properly protected (403 responses), and SSL/TLS encryption is correctly implemented. However, critical security header deficiencies exist across all scanned pages. The absence of X-Content-Type-Options and X-Frame-Options headers on public-facing pages exposes the application to MIME-sniffing and clickjacking attacks. Additionally, missing HSTS, CSP, Referrer-Policy, and Permissions-Policy headers leave the application vulnerable to protocol downgrade attacks, XSS/injection attacks, and unauthorized API access via third-party sites.",
    "recommendations": [
      "Immediately add X-Content-Type-Options: nosniff and X-Frame-Options: SAMEORIGIN headers to all pages (minimum requirement), especially public endpoints like / and /quote",
      "Implement Strict-Transport-Security (HSTS) header with max-age=31536000 to enforce HTTPS-only connections and prevent downgrade attacks",
      "Deploy a Content-Security-Policy (CSP) header to mitigate XSS and injection vulnerabilities; start with a restrictive policy and refine based on application dependencies",
      "Add Referrer-Policy: strict-origin-when-cross-origin to prevent sensitive referrer information leakage to third-party sites",
      "Configure Permissions-Policy to restrict access to sensitive browser APIs (camera, microphone, geolocation, etc.) that could be exploited",
      "Apply all recommended headers consistently across the entire application, not just admin panels; use a centralized middleware approach for standardization",
      "Document and test the header configuration in a development environment before production deployment to ensure no functionality is broken"
    ],
    "riskLevel": "high"
  }
}
