{
  "generatedAt": "2026-02-25T04:45:14.260Z",
  "agent": "security",
  "grade": "F",
  "counts": {
    "critical": 5,
    "high": 3,
    "medium": 0,
    "low": 1
  },
  "authEnforcement": [
    {
      "endpoint": "/api/admin/pricing",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/compliance",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/approval",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/pricing-report",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/conversions",
      "status": 200,
      "protected": false,
      "severity": "critical"
    }
  ],
  "securityHeaders": [
    {
      "page": "/",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/services/send-transport",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/admin",
      "headers": {
        "x-content-type-options": "nosniff",
        "x-frame-options": "DENY",
        "strict-transport-security": "max-age=31536000; includeSubDomains",
        "content-security-policy": "frame-ancestors 'none'; connect-src 'self' http://127.0.0.1:*; default-src https: 'unsafe-inline'",
        "referrer-policy": "strict-origin-when-cross-origin",
        "permissions-policy": null
      },
      "missingRequired": [],
      "missingRecommended": [
        "permissions-policy"
      ],
      "severity": "low"
    },
    {
      "page": "/quote",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    }
  ],
  "infoLeakage": [
    {
      "endpoint": "/api/quote/estimate",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/contact/submit",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/ai/draft",
      "status": 401,
      "leaks": [],
      "severity": "ok"
    }
  ],
  "ssl": {
    "url": "https://afj-staging.ascendtechgroup.co.uk",
    "isHttps": true,
    "status": 200,
    "severity": "ok"
  },
  "aiAnalysis": {
    "summary": "AFJ Limited's staging environment has critical security vulnerabilities that require immediate remediation. Five admin API endpoints (/api/admin/pricing, /api/admin/compliance, /api/admin/approval, /api/admin/pricing-report, /api/admin/conversions) are completely unprotected and accessible without authentication, exposing sensitive business data including pricing strategies, compliance records, and financial conversions. Additionally, essential security headers are missing from the majority of public-facing pages, leaving the application vulnerable to clickjacking, XSS, and content-type attacks.",
    "recommendations": [
      "Immediately implement authentication and authorization checks on all /api/admin/* endpoints using role-based access control (RBAC) and verify credentials before returning sensitive data",
      "Add required security headers (X-Content-Type-Options: nosniff, X-Frame-Options: DENY) to all pages, especially / , /services/send-transport, and /quote",
      "Deploy Strict-Transport-Security (HSTS), Content-Security-Policy (CSP), Referrer-Policy, and Permissions-Policy headers site-wide following the security implementation pattern already correctly applied to /admin",
      "Conduct a comprehensive security audit of all API endpoints to identify and remediate similar unprotected sensitive endpoints",
      "Implement API rate limiting and IP whitelisting on admin endpoints as additional protective layers",
      "Remove 'unsafe-inline' from CSP directives and establish a proper external stylesheet/script strategy",
      "Establish security header policies as a standard requirement in your deployment pipeline to prevent regression"
    ],
    "riskLevel": "critical"
  }
}
