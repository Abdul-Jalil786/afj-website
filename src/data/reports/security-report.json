{
  "generatedAt": "2026-02-18T02:48:12.337Z",
  "agent": "security",
  "grade": "D",
  "counts": {
    "critical": 0,
    "high": 4,
    "medium": 0,
    "low": 0
  },
  "authEnforcement": [
    {
      "endpoint": "/api/admin/pricing",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/compliance",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/approval",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/pricing-report",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/conversions",
      "status": 403,
      "protected": true,
      "severity": "ok"
    }
  ],
  "securityHeaders": [
    {
      "page": "/",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/services/send-transport",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/admin",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": "SAMEORIGIN",
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": "same-origin",
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/quote",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    }
  ],
  "infoLeakage": [
    {
      "endpoint": "/api/quote/estimate",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/contact/submit",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/ai/draft",
      "status": 401,
      "leaks": [],
      "severity": "ok"
    }
  ],
  "ssl": {
    "url": "https://afj-staging.ascendtechgroup.co.uk",
    "isHttps": true,
    "status": 200,
    "severity": "ok"
  },
  "aiAnalysis": {
    "summary": "AFJ Limited's security posture shows good authentication controls with all admin endpoints properly protected (403 responses), and SSL/TLS is correctly implemented. However, the application has critical security header gaps across all tested pages, with essential protections like X-Content-Type-Options and X-Frame-Options missing from multiple endpoints. This leaves the application vulnerable to clickjacking, MIME-type sniffing, and XSS attacks. The missing security headers represent the primary risk requiring immediate remediation.",
    "recommendations": [
      "Implement X-Content-Type-Options: nosniff header on all pages to prevent MIME-type sniffing attacks",
      "Add X-Frame-Options: SAMEORIGIN (or DENY if framing is unnecessary) to all pages to prevent clickjacking; currently only present on /admin",
      "Deploy Strict-Transport-Security header with appropriate max-age value (minimum 31536000 seconds) to enforce HTTPS across all endpoints",
      "Establish a Content-Security-Policy header to mitigate XSS attacks; tailor directives based on application requirements",
      "Add Referrer-Policy header to control referrer information leakage; use 'strict-origin-when-cross-origin' as default",
      "Implement Permissions-Policy header to restrict access to browser features (camera, microphone, geolocation, etc.)",
      "Conduct a comprehensive security header audit across the entire application, not just sampled pages",
      "Consider using automated security header tools or middleware (e.g., helmet.js for Node.js, web server modules) for consistent enforcement"
    ],
    "riskLevel": "high"
  }
}
