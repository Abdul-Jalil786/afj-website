{
  "generatedAt": "2026-02-24T04:44:54.496Z",
  "agent": "security",
  "grade": "F",
  "counts": {
    "critical": 5,
    "high": 3,
    "medium": 0,
    "low": 1
  },
  "authEnforcement": [
    {
      "endpoint": "/api/admin/pricing",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/compliance",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/approval",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/pricing-report",
      "status": 200,
      "protected": false,
      "severity": "critical"
    },
    {
      "endpoint": "/api/admin/conversions",
      "status": 200,
      "protected": false,
      "severity": "critical"
    }
  ],
  "securityHeaders": [
    {
      "page": "/",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/services/send-transport",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/admin",
      "headers": {
        "x-content-type-options": "nosniff",
        "x-frame-options": "DENY",
        "strict-transport-security": "max-age=31536000; includeSubDomains",
        "content-security-policy": "frame-ancestors 'none'; connect-src 'self' http://127.0.0.1:*; default-src https: 'unsafe-inline'",
        "referrer-policy": "strict-origin-when-cross-origin",
        "permissions-policy": null
      },
      "missingRequired": [],
      "missingRecommended": [
        "permissions-policy"
      ],
      "severity": "low"
    },
    {
      "page": "/quote",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    }
  ],
  "infoLeakage": [
    {
      "endpoint": "/api/quote/estimate",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/contact/submit",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/ai/draft",
      "status": 401,
      "leaks": [],
      "severity": "ok"
    }
  ],
  "ssl": {
    "url": "https://afj-staging.ascendtechgroup.co.uk",
    "isHttps": true,
    "status": 200,
    "severity": "ok"
  },
  "aiAnalysis": {
    "summary": "AFJ Limited's staging environment presents critical security vulnerabilities that require immediate remediation. Five admin API endpoints are completely unprotected and accessible without authentication, exposing sensitive operations including pricing, compliance, and conversion data. Additionally, security headers are missing from most pages, leaving the application vulnerable to XSS, clickjacking, and MIME-type attacks. While SSL/TLS is properly configured and data leakage appears contained, the authentication bypass vulnerabilities pose an existential risk to business operations and regulatory compliance.",
    "recommendations": [
      "CRITICAL: Implement authentication/authorization checks on all five admin API endpoints (/api/admin/pricing, /api/admin/compliance, /api/admin/approval, /api/admin/pricing-report, /api/admin/conversions) - verify token validation, role-based access control, and session management before deploying to production",
      "CRITICAL: Conduct an immediate audit to identify if these endpoints are accessible from the internet or only internally; if internet-facing, treat as an active breach and review audit logs for unauthorized access",
      "Add required security headers (X-Content-Type-Options: nosniff, X-Frame-Options: DENY) to all pages, particularly public-facing routes (/, /services/send-transport, /quote)",
      "Implement comprehensive security headers across the application: add HSTS with includeSubDomains, establish restrictive CSP policy (remove 'unsafe-inline'), add Referrer-Policy: strict-origin-when-cross-origin, and Permissions-Policy to disable unnecessary APIs",
      "Review and strengthen the CSP on /admin page - current policy allows unsafe-inline and localhost connections (http://127.0.0.1:*) which should be restricted in production",
      "Establish automated security header validation in CI/CD pipeline to prevent regression",
      "Conduct full security code review before production release, focusing on authentication middleware and API endpoint protection"
    ],
    "riskLevel": "critical"
  }
}
