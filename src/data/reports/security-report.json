{
  "generatedAt": "2026-02-18T02:49:44.976Z",
  "agent": "security",
  "grade": "D",
  "counts": {
    "critical": 0,
    "high": 4,
    "medium": 0,
    "low": 0
  },
  "authEnforcement": [
    {
      "endpoint": "/api/admin/pricing",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/compliance",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/approval",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/pricing-report",
      "status": 403,
      "protected": true,
      "severity": "ok"
    },
    {
      "endpoint": "/api/admin/conversions",
      "status": 403,
      "protected": true,
      "severity": "ok"
    }
  ],
  "securityHeaders": [
    {
      "page": "/",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/services/send-transport",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/admin",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": "SAMEORIGIN",
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": "same-origin",
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "permissions-policy"
      ],
      "severity": "high"
    },
    {
      "page": "/quote",
      "headers": {
        "x-content-type-options": null,
        "x-frame-options": null,
        "strict-transport-security": null,
        "content-security-policy": null,
        "referrer-policy": null,
        "permissions-policy": null
      },
      "missingRequired": [
        "x-content-type-options",
        "x-frame-options"
      ],
      "missingRecommended": [
        "strict-transport-security",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ],
      "severity": "high"
    }
  ],
  "infoLeakage": [
    {
      "endpoint": "/api/quote/estimate",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/contact/submit",
      "status": 400,
      "leaks": [],
      "severity": "ok"
    },
    {
      "endpoint": "/api/ai/draft",
      "status": 401,
      "leaks": [],
      "severity": "ok"
    }
  ],
  "ssl": {
    "url": "https://afj-staging.ascendtechgroup.co.uk",
    "isHttps": true,
    "status": 200,
    "severity": "ok"
  },
  "aiAnalysis": {
    "summary": "AFJ Limited's web application demonstrates strong authentication controls with all admin endpoints properly protected (returning 403 for unauthorized access) and valid HTTPS implementation. However, the security posture is significantly weakened by pervasive absence of critical security headers across multiple pages. Four pages lack essential HTTP security headers (X-Content-Type-Options and X-Frame-Options), leaving the application vulnerable to MIME-sniffing attacks and clickjacking. Additionally, recommended security headers like HSTS, CSP, Referrer-Policy, and Permissions-Policy are missing across all tested pages, reducing defense-in-depth protections. No data leakage was detected in error responses, which is positive.",
    "recommendations": [
      "Immediately implement X-Content-Type-Options: nosniff header on all pages to prevent MIME-sniffing attacks",
      "Add X-Frame-Options: SAMEORIGIN (or DENY if no framing needed) to all pages to prevent clickjacking; note that /admin already has this set correctly",
      "Implement Strict-Transport-Security (HSTS) header with appropriate max-age (e.g., 31536000) to enforce HTTPS-only connections",
      "Deploy a Content-Security-Policy header tailored to your application's needs to mitigate XSS and injection attacks",
      "Add Referrer-Policy header (recommend 'strict-origin-when-cross-origin') across all pages to control referrer information leakage",
      "Implement Permissions-Policy header to restrict browser APIs and features your application doesn't require",
      "Conduct a security headers audit across your entire application and apply consistently via web server configuration (nginx/Apache) or application middleware to ensure persistent implementation"
    ],
    "riskLevel": "high"
  }
}
