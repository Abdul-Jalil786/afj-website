{
  "fixes": [
    {
      "id": "fix_1771358098163_6v7",
      "source": "security-agent",
      "issueType": "missing-security-headers",
      "severity": "high",
      "title": "Add missing security headers: x-content-type-options, x-frame-options",
      "description": "Missing security headers on /: x-content-type-options, x-frame-options",
      "file": "src/middleware.ts",
      "currentCode": "export const onRequest: MiddlewareHandler = (context, next) => {\n  return next();\n};",
      "proposedCode": "export const onRequest: MiddlewareHandler = (context, next) => {\n  const response = next();\n  \n  return response.then((res) => {\n    res.headers.set('x-content-type-options', 'nosniff');\n    res.headers.set('x-frame-options', 'DENY');\n    return res;\n  });\n};",
      "diffSummary": "Add x-content-type-options and x-frame-options security headers to middleware response",
      "status": "pending",
      "createdAt": "2026-02-17",
      "approvedAt": null,
      "appliedAt": null,
      "rejectedAt": null,
      "rejectedReason": null
    },
    {
      "id": "fix_1771358100315_lse",
      "source": "security-agent",
      "issueType": "missing-security-headers",
      "severity": "high",
      "title": "Add missing security headers: x-content-type-options",
      "description": "Missing security headers on /admin: x-content-type-options",
      "file": "src/middleware.ts",
      "currentCode": "",
      "proposedCode": "import { defineMiddleware } from 'astro:middleware';\n\nexport const onRequest = defineMiddleware((context, next) => {\n  context.response.headers.set('x-content-type-options', 'nosniff');\n  context.response.headers.set('x-frame-options', 'DENY');\n  context.response.headers.set('x-xss-protection', '1; mode=block');\n  context.response.headers.set('referrer-policy', 'strict-origin-when-cross-origin');\n  return next();\n});",
      "diffSummary": "Add x-content-type-options: nosniff security header and complementary headers to middleware",
      "status": "pending",
      "createdAt": "2026-02-17",
      "approvedAt": null,
      "appliedAt": null,
      "rejectedAt": null,
      "rejectedReason": null
    }
  ]
}
